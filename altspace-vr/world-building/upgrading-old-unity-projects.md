---
title: 升级旧 Unity 项目
description: 了解如何将内容更新到最新版本的 Unity。
ms.date: 10/19/2021
ms.topic: article
keywords: 工具包，世界，unity，更新，着色器，上载器，故障排除
ms.openlocfilehash: 06af70164e5bf870a10bf1ee9e949e09dfa69fd2
ms.sourcegitcommit: 8c58f9f9ad1a3f9534141dee2c78e32792d0db7a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/25/2021
ms.locfileid: "130302373"
---
<a name="upgrading-old-unity-projects"></a>升级旧 Unity 项目
=============================

多年来，AltspaceVR 已经完成了几个罕见的升级，要求用户更改其内容。 如果你发现过去上传的模板或工具包在最新版本的 AltspaceVR 中不可访问，请按照此指南操作，以重新启动并运行你的内容。

> [!NOTE]
> 在执行本指南中的任何步骤之前，应创建项目的完整备份，以防升级不会顺利进行。 最简单的方法是创建整个项目文件夹的第二个副本。 对于更高级的解决方案，请考虑使用 Git 和 GitHub 等版本控制系统。

<a name="overview"></a>概述
---------

到撰写本文时为止，当前版本的 AltspaceVR 使用以下配置：

* 游戏引擎： Unity 2020.3.18 f1 (也可接受： Unity 2020.3.9 f1) 
* Upload工具：上载2。2
* 呈现：通用呈现管道 (URP) 
* 立体声模式： Single-Pass 实例化 (SPI) 

如果你的项目 Unity 版本早于2020.3，则你可能需要立即获取所有这些更新，因此请从开头开始使用本指南。 如果你已在 Unity 2020.3 上，但对于上载者0.9，则从步骤6开始。

1. **备份项目** -创建整个项目目录的副本，并将其放在一个安全的位置。 此升级是一种破坏性升级，因此在完成后，你将丢失原始项目文件。
    如果在此升级过程中遇到任何问题，则需要一个干净的项目副本才能回退。

2. **删除旧的上载** 程序-如果你的项目使用 AltspaceVR 上载程序0.8 或更早版本，请执行此步骤。 在 Unity 已关闭的情况下，删除以下文件/文件夹，并且它是对应的元文件。 如果文件/文件夹不存在，只需跳过它。

    * 资产/Altspace
    * 资产/插件
    * 资产/Prototyping/测试-文件夹
    * 资产/Prototyping/Readme.txt
    * 资产/资源/bg. jpeg
    * 资产/资源/bg2
    * 资产/资源/logo.png
    * 资产/资源/UserPreferences
    * 资产/DFloor_v004 fbx

3. **删除已处理的资产** -如果要升级到新的 Unity 版本，请执行此步骤。 在 Unity 已关闭的情况下，从项目中删除库文件夹。 这是一个 Unity 系统文件夹，其中包含特定于引擎的资产和文件，这些文件是从资产文件夹内容中自动生成的，并)  (。

4. **下载引擎版本** -如果要升级到新的 Unity 版本，请执行此步骤。 打开 Unity 中心，并从下载存档 ([链接到引擎安装](unityhub://2020.3.18f1/a7d1c678663c)) 中安装 unity 2020.3.18 f1。
    * 如果在 Windows 电脑上进行构建，请查看 Android 和 Mac 版本支持框。
    * 如果是在 Mac 上生成，请查看 Android 和 Windows 生成支持框。

5. **升级项目** -在 Unity 2020.3.18 f1 中打开已清理的项目，并允许 Unity 升级项目。
    此操作需要一些时间。

6. **下载上载** 程序-在 [此处](https://aka.ms/AvrUrpUploader)下载最新版本的上载程序，并将其保存到项目的包文件夹中。 此文件的文件扩展名应为 "tgz"。
    > [!NOTE]
    > 如果使用 Safari 浏览器进行下载，则该浏览器将自动提取到 Unity 不能使用的 "tar" 文件中。 你可以使用不同的浏览器来下载，或使用 "gzip" 系统实用程序来对其进行重新压缩。
    
7. **安装上载** 程序-在 Unity 编辑器的包管理器中安装上载程序：
    1. 打开 "Unity 程序包管理器" 窗口： "Windows >" 程序包管理器
    2. 在窗口左上方，单击 "+" 图标，然后选择 "从 tarball 添加包"。
    3. 选择上一步中下载的 tgz 文件。
    4. 等待 Unity 将包解压缩。

8. **打开上载** 程序-如果安装成功，将在顶部栏中提供 "AltspaceVR" 菜单。
    此菜单包含单独的用于工具包和模板的窗口。 打开最适合你的项目的一个。
    第一次打开窗口时，它会将项目设置配置为与 Altspace 游戏客户端匹配：启用通用呈现管道，并 Single-Pass 实例化

9. **修复着色** 器-当首次运行安装程序时，可能会暂时显示 powershell 窗口。
    系统可能会提示你升级某些自定义/下载的着色器。 如果你批准此提示，则 powershell 脚本将尝试自动升级你的着色器，但成功的可能性较低。 你将需要手动检查着色器是否在 URP 中仍能正常工作。

10. **修复材料** -在升级过程中，部分/全部资料可能会变为粉红色/洋红色。 这表示该材料使用的着色器中有错误。 如果使用了 Unity 内置着色器，通常可以从菜单自动将这些内容迁移到 URP 兼容着色器：编辑 > 渲染管道 > 通用渲染管道 > 将 Project 材料升级到 UniversalRP 材料。

11. **生成和上载** -此时，你的项目应完全升级。 按照 [入门](world-building-toolkit-getting-started.md) 指南中的说明生成并上传包/模板。

<a name="troubleshooting-tips"></a>疑难解答指南
---------------------

1. 如果你发现你的内容仅以 "VR" 模式显示，则可能使用的自定义着色器不支持 SPI 渲染。 需要选择其他着色器，或遵循 [Unity 的 SPI 升级指南](https://docs.unity3d.com/Manual/SinglePassInstancing.html) ，手动编辑着色器并添加支持。

2. 如果你发现某些内容在游戏中出现粉色/洋红色或完全不可见，则这可能是由于着色器与 URP 不兼容引起的。 你将需要替换着色器或自行升级它。